<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Caterers for Shiva Meals - Neshama</title>
    <meta name="description" content="Local caterers experienced in preparing meals for shiva. Kosher options, delivery, and community-trusted providers in Toronto and Montreal.">
    <meta name="theme-color" content="#3E2723">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Neshama">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400;1,500&family=Source+Serif+4:ital,opsz,wght@0,8..60,300;0,8..60,400;0,8..60,500;0,8..60,600;1,8..60,400&display=swap" rel="stylesheet">
    <style>
        :root {
            --sage: #B2BEB5;
            --sage-dark: #8a9a8d;
            --terracotta: #D2691E;
            --warm-beige: #F5F5DC;
            --cream: #FAF9F6;
            --dark-brown: #3E2723;
            --light-taupe: #D4C5B9;
            --gold: #C9A96E;
            --soft-shadow: rgba(62, 39, 35, 0.08);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }

        ::selection {
            background: rgba(210, 105, 30, 0.2);
            color: var(--dark-brown);
        }

        body {
            font-family: 'Source Serif 4', serif;
            background: linear-gradient(135deg, var(--cream) 0%, var(--warm-beige) 100%);
            color: var(--dark-brown);
            line-height: 1.7;
            min-height: 100vh;
        }

        a { color: var(--terracotta); text-decoration: none; }
        a:hover { text-decoration: underline; }

        a:focus-visible, button:focus-visible {
            outline: 2px solid var(--terracotta);
            outline-offset: 3px;
            border-radius: 4px;
        }

        /* ── Navigation ── */
        .nav {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--light-taupe);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            background: rgba(255,255,255,0.6);
            backdrop-filter: blur(8px);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-brand {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            font-weight: 400;
            color: var(--dark-brown);
            text-decoration: none;
            letter-spacing: 0.02em;
        }

        .nav-brand:hover { opacity: 0.7; text-decoration: none; }
        .nav-links { display: flex; gap: 1.5rem; flex-wrap: wrap; }
        .nav-links a { color: var(--dark-brown); text-decoration: none; font-size: 1rem; transition: color 0.2s; }
        .nav-links a:hover { color: var(--terracotta); text-decoration: none; }

        /* ── Hero ── */
        .hero {
            text-align: center;
            padding: 4rem 1.5rem 2.5rem;
        }

        .hero h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2.8rem;
            font-weight: 400;
            margin-bottom: 0.5rem;
        }

        .hero .subtitle {
            font-size: 1.2rem;
            color: var(--sage-dark);
            max-width: 560px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* ── Container ── */
        .container {
            max-width: 760px;
            margin: 0 auto;
            padding: 0 1.5rem 4rem;
        }

        /* ── Intro note ── */
        .intro-note {
            text-align: center;
            font-size: 1.05rem;
            color: var(--sage-dark);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        /* ── Filter Bar ── */
        .filter-bar {
            display: flex;
            justify-content: center;
            gap: 0.6rem;
            flex-wrap: wrap;
            margin-bottom: 2.5rem;
        }

        .filter-btn {
            padding: 0.5rem 1.25rem;
            border: 1.5px solid var(--light-taupe);
            border-radius: 2rem;
            background: white;
            font-family: 'Source Serif 4', serif;
            font-size: 0.95rem;
            color: var(--dark-brown);
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-btn:hover {
            border-color: var(--terracotta);
            color: var(--terracotta);
        }

        .filter-btn.active {
            background: var(--terracotta);
            border-color: var(--terracotta);
            color: white;
        }

        /* ── Caterer Cards ── */
        .caterer-card {
            background: white;
            border-radius: 1rem;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 12px var(--soft-shadow);
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }

        .caterer-card.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .caterer-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .caterer-name {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.8rem;
            font-weight: 500;
            color: var(--dark-brown);
        }

        .caterer-area {
            font-size: 0.9rem;
            color: var(--sage-dark);
            background: var(--cream);
            padding: 0.3rem 0.9rem;
            border-radius: 1rem;
            white-space: nowrap;
            margin-top: 0.3rem;
        }

        .caterer-description {
            font-size: 1.1rem;
            line-height: 1.85;
            margin-bottom: 1.25rem;
        }

        .caterer-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.25rem;
        }

        .badge {
            font-size: 0.9rem;
            padding: 0.3rem 0.8rem;
            border-radius: 0.5rem;
            border: 1px solid var(--light-taupe);
            background: var(--cream);
            color: var(--dark-brown);
        }

        .badge.kosher {
            background: #f0fdf4;
            border-color: #86efac;
            color: #166534;
        }

        .badge.delivery {
            background: #eff6ff;
            border-color: #93c5fd;
            color: #1e40af;
        }

        .badge.online {
            background: #faf5ff;
            border-color: #c4b5fd;
            color: #5b21b6;
        }

        .caterer-contact {
            padding-top: 1.25rem;
            border-top: 1px solid rgba(210, 105, 30, 0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: center;
        }

        .caterer-contact a {
            font-size: 1.05rem;
        }

        /* ── Loading / Empty ── */
        .loading-state, .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--sage-dark);
            font-size: 1.1rem;
        }

        /* ── Partner CTA ── */
        .partner-section {
            background: white;
            border-radius: 1rem;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 12px var(--soft-shadow);
            text-align: center;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }

        .partner-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .partner-section h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.6rem;
            font-weight: 500;
            color: var(--dark-brown);
            margin-bottom: 0.75rem;
        }

        .partner-section p {
            font-size: 1.05rem;
            line-height: 1.7;
            color: var(--sage-dark);
            margin-bottom: 1rem;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .partner-link {
            display: inline-block;
            border: 1.5px solid var(--terracotta);
            color: var(--terracotta);
            padding: 0.7rem 2rem;
            border-radius: 2rem;
            font-family: 'Source Serif 4', serif;
            font-size: 1.05rem;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .partner-link:hover {
            background: var(--terracotta);
            color: white;
            text-decoration: none;
        }

        /* ── Guide link ── */
        .guide-link-section {
            text-align: center;
            padding: 1rem 0 0;
        }

        .guide-link-section p {
            font-size: 1.05rem;
            color: var(--sage-dark);
        }

        /* ── Disclaimers ── */
        .caterer-disclaimer {
            font-size: 0.8rem;
            color: var(--sage-dark);
            line-height: 1.5;
            margin-top: 1rem;
            padding-top: 0.75rem;
            border-top: 1px solid var(--light-taupe);
            font-style: italic;
        }

        .page-disclaimer {
            text-align: center;
            padding: 1.5rem 0 0;
        }

        .page-disclaimer p {
            font-size: 0.85rem;
            color: var(--sage-dark);
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
            font-style: italic;
        }

        /* ── Footer ── */
        footer {
            padding: 2rem 1.5rem;
            border-top: 1px solid var(--light-taupe);
            text-align: center;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            margin-bottom: 1.25rem;
        }

        .footer-links a { color: var(--dark-brown); text-decoration: none; font-size: 1rem; transition: color 0.2s; }
        .footer-links a:hover { color: var(--terracotta); text-decoration: none; }
        .footer-copy { font-size: 0.85rem; color: var(--sage-dark); }

        /* ── Stats Banner ── */
        .stats-banner {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1.5rem;
            padding: 0.75rem 1.5rem;
            font-size: 0.95rem;
            color: var(--sage-dark);
            text-align: center;
            flex-wrap: wrap;
        }

        .stats-banner .stat {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            white-space: nowrap;
        }

        .stats-banner .stat-num {
            font-weight: 600;
            color: var(--dark-brown);
        }

        .stats-banner .stat-divider {
            color: var(--light-taupe);
            font-size: 0.7rem;
        }

        /* ── Responsive ── */
        @media (max-width: 600px) {
            .nav-divider { display: none; }
            .nav-links .nav-secondary { opacity: 1; font-size: 1rem; }
            .nav { gap: 1rem; }
            .nav-links { gap: 1rem; }
            .hero h1 { font-size: 2.2rem; }
            .hero { padding: 3rem 1.5rem 2rem; }
            .caterer-card { padding: 1.75rem 1.5rem; }
            .caterer-header { flex-direction: column; gap: 0.5rem; }
            .caterer-name { font-size: 1.5rem; }
            .caterer-contact { gap: 1rem; }
            .partner-section { padding: 2rem 1.5rem; }
            .footer-links { gap: 1.25rem; }
            .filter-bar { gap: 0.4rem; }
            .filter-btn { padding: 0.4rem 1rem; font-size: 0.9rem; }
        }
    </style>
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Neshama — Every Soul Remembered">
    <meta name="twitter:description" content="Obituaries and memorials from Toronto and Montreal's Jewish funeral homes, in one place.">
    <meta name="twitter:image" content="https://neshama.ca/og-image.png">
    <script defer data-domain="neshama.ca" src="https://plausible.io/js/script.js"></script>
</head>
<body>

    <nav class="nav">
        <a href="/" class="nav-brand">Neshama</a>
        <div class="nav-links">
            <a href="/feed">Listings</a>
            <span class="nav-divider"></span>
            <a href="/shiva-essentials" class="nav-secondary">Essentials</a>
            <a href="/gifts" class="nav-secondary">Gifts</a>
            <a href="/about" class="nav-secondary">About</a>
            <a href="/shiva/organize" style="background:#C75B12;color:white;padding:0.45rem 1.1rem;border-radius:8px;font-weight:600;font-size:0.88rem;">Organize Shiva</a>
        </div>
    </nav>

    <div style="max-width: 1100px; margin: 0 auto; padding: 1rem 2rem 0;">
        <a href="/feed" style="color: var(--sage-dark); text-decoration: none; font-size: 0.9rem;">&larr; Back to feed</a>
        <span style="color: var(--light-taupe); margin: 0 0.5rem;">/</span>
        <a href="/shiva/organize" style="color: var(--sage-dark); text-decoration: none; font-size: 0.9rem;">Organize a shiva</a>
    </div>

    <header class="hero">
        <h1>Local Caterers for Shiva Meals</h1>
        <p class="subtitle">Community-trusted caterers experienced in preparing meals for families sitting shiva</p>
    </header>

    <div class="stats-banner" id="statsBanner" style="display:none;">
        <span class="stat"><span class="stat-num" id="statObits">0</span> obituaries tracked</span>
        <span class="stat-divider">&middot;</span>
        <span class="stat"><span class="stat-num" id="statShiva">0</span> active shiva pages</span>
        <span class="stat-divider">&middot;</span>
        <span class="stat"><span class="stat-num" id="statCaterers">0</span> caterers listed</span>
    </div>

    <div class="container">

        <p class="intro-note">
            These caterers have experience preparing meals for shiva houses. All listings are verified by Neshama.
            Contact them directly to discuss your needs.
        </p>

        <div class="filter-bar" id="filterBar">
            <button class="filter-btn" data-filter="kosher" onclick="toggleFilter(this)">Kosher</button>
            <button class="filter-btn" data-filter="delivery" onclick="toggleFilter(this)">Delivery Available</button>
            <button class="filter-btn" data-filter="online_ordering" onclick="toggleFilter(this)">Online Ordering</button>
        </div>

        <div id="catererList">
            <div class="loading-state">Loading caterers...</div>
        </div>

        <div class="partner-section" id="partnerSection" data-animate>
            <h2>Are You a Caterer?</h2>
            <p>
                If your business regularly prepares meals for shiva houses and you'd
                like to be listed here, we'd love to hear from you.
            </p>
            <a href="/shiva/caterers/apply" class="partner-link">Become a Partner Caterer</a>
        </div>

        <div class="guide-link-section">
            <p>Planning meals yourself? Read our <a href="/shiva/guide">guide to coordinating shiva support</a>.</p>
        </div>

        <div class="page-disclaimer">
            <p>Neshama provides this directory as a community resource. Listed caterers are independent businesses. Neshama does not endorse, guarantee, or assume responsibility for the quality, safety, or delivery of any products or services. Please verify dietary certifications and requirements directly with the caterer.</p>
        </div>

    </div>

    <footer>
        <nav class="footer-links">
            <a href="/">Home</a>
            <a href="/shiva/organize">Organize a Shiva</a>
            <a href="/about">About</a>
            <a href="/faq">FAQ</a>
            <a href="/shiva-essentials">Shiva Essentials</a>
            <a href="/what-to-bring-to-a-shiva">What to Bring</a>
            <a href="/gifts">Send a Gift</a>
            <a href="/directory">Directory</a>
            <a href="/privacy">Privacy</a>
            <a href="mailto:contact@neshama.ca">Contact</a>
        </nav>
        <p class="footer-copy">Built with care for the Jewish community</p>
    </footer>

    <script>
    (function() {
        var activeFilters = {};
        var allCaterers = [];

        window.toggleFilter = function(btn) {
            var filter = btn.getAttribute('data-filter');
            if (activeFilters[filter]) {
                delete activeFilters[filter];
                btn.classList.remove('active');
            } else {
                activeFilters[filter] = true;
                btn.classList.add('active');
            }
            loadCaterers();
        };

        function loadCaterers() {
            var params = [];
            if (activeFilters.kosher) params.push('kosher=true');
            if (activeFilters.delivery) params.push('delivery=true');
            if (activeFilters.online_ordering) params.push('online_ordering=true');

            var url = '/api/caterers' + (params.length ? '?' + params.join('&') : '');

            fetch(url)
                .then(function(r) { return r.json(); })
                .then(function(result) {
                    if (result.status === 'success') {
                        allCaterers = result.data;
                        renderCaterers();
                    } else {
                        document.getElementById('catererList').innerHTML =
                            '<div class="empty-state">Unable to load caterers. Please try again later.</div>';
                    }
                })
                .catch(function() {
                    document.getElementById('catererList').innerHTML =
                        '<div class="empty-state">Unable to load caterers. Please try again later.</div>';
                });
        }

        function escapeHtml(str) {
            if (!str) return '';
            var div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        function kosherLabel(level) {
            if (level === 'certified_kosher') return 'Certified Kosher';
            if (level === 'kosher_style') return 'Kosher-style';
            return '';
        }

        function renderCaterers() {
            var container = document.getElementById('catererList');

            if (!allCaterers.length) {
                container.innerHTML = '<div class="empty-state">No caterers match your filters. Try removing a filter.</div>';
                return;
            }

            var html = '';
            allCaterers.forEach(function(c) {
                html += '<div class="caterer-card" data-animate>';
                html += '<div class="caterer-header">';
                html += '<h2 class="caterer-name">' + escapeHtml(c.business_name) + '</h2>';
                html += '<span class="caterer-area">' + escapeHtml(c.delivery_area) + '</span>';
                html += '</div>';

                html += '<p class="caterer-description">' + escapeHtml(c.shiva_menu_description) + '</p>';

                html += '<div class="caterer-badges">';
                var kl = kosherLabel(c.kosher_level);
                if (kl) html += '<span class="badge kosher">' + kl + '</span>';
                if (c.has_delivery) html += '<span class="badge delivery">Delivery</span>';
                if (c.has_online_ordering) html += '<span class="badge online">Online Ordering</span>';
                html += '<span class="badge">' + escapeHtml(c.price_range) + '</span>';
                html += '</div>';

                html += '<div class="caterer-contact">';
                if (c.website) html += '<a href="' + escapeHtml(c.website) + '" target="_blank" rel="noopener">' + escapeHtml(c.website.replace(/^https?:\/\/(www\.)?/, '').replace(/\/$/, '')) + '</a>';
                if (c.phone) html += '<a href="tel:' + escapeHtml(c.phone) + '">' + escapeHtml(c.phone) + '</a>';
                if (c.email) html += '<a href="mailto:' + escapeHtml(c.email) + '">' + escapeHtml(c.email) + '</a>';
                if (c.instagram) {
                    var ig = c.instagram.replace(/^@/, '');
                    html += '<a href="https://instagram.com/' + escapeHtml(ig) + '" target="_blank" rel="noopener">@' + escapeHtml(ig) + '</a>';
                }
                html += '</div>';

                html += '<p class="caterer-disclaimer">Neshama provides this directory as a community resource. Listed caterers are independent businesses. Neshama does not endorse, guarantee, or assume responsibility for the quality, safety, or delivery of any products or services. Please verify dietary certifications and requirements directly with the caterer.</p>';

                html += '</div>';
            });

            container.innerHTML = html;
            observeCards();
        }

        function observeCards() {
            var els = document.querySelectorAll('[data-animate]:not(.visible)');
            if ('IntersectionObserver' in window) {
                var observer = new IntersectionObserver(function(entries) {
                    entries.forEach(function(entry) {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.12, rootMargin: '0px 0px -40px 0px' });
                els.forEach(function(el) { observer.observe(el); });
            } else {
                els.forEach(function(el) { el.classList.add('visible'); });
            }
        }

        // Load stats banner
        fetch('/api/directory-stats')
            .then(function(r) { return r.json(); })
            .then(function(result) {
                if (result.status === 'success' && result.data) {
                    var d = result.data;
                    if (d.obituary_count > 0 || d.caterer_count > 0) {
                        document.getElementById('statObits').textContent = d.obituary_count;
                        document.getElementById('statShiva').textContent = d.active_shiva_count;
                        document.getElementById('statCaterers').textContent = d.caterer_count;
                        document.getElementById('statsBanner').style.display = 'flex';
                    }
                }
            })
            .catch(function() {});

        // Initial load
        loadCaterers();

        // Observe partner section
        observeCards();
    })();
    </script>
    <script>if('serviceWorker' in navigator){navigator.serviceWorker.register('/sw.js');}</script>
</body>
</html>
